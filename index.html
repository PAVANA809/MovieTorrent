<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello torrent</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <div class="searchbar">
            <input type="text" v-model="searchItem" v-on:keyup.enter="search()">
            <button @click="search()">Search</button>
        </div>
        <div class="torrent" v-for="obj in data" :key="obj.id">
            <h4>Title: {{obj.title}}</h4>
            <p>Size: {{obj.size}}</p>
            <p>Seeds: {{obj.seeds}}</p>
            <p>Peers: {{obj.peers}}</p>
            <button @click="copy(obj.magnet)">Magnet</button>
            <a v-if="obj.imdb" :href="'https://www.imdb.com/title/' + obj.imdb + '/'" target="_blank">IMDB</a>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
</body>
<script>
    var app = new Vue({
  el: '#app',
  data: {
    searchItem: "",
    data: null
  },
  methods: {
    async search(){
        try {
        const response = await fetch("https://movie-torrent-api.onrender.com/search/"+this.searchItem, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            },
        });

        if (response.ok) {
            const data = await response.json();
            this.data = data['data']
        } else {
            alert("Please try again later....");
        }
    } catch (error) {
        console.error("Fetch error:", error);
        alert("An error occurred. Please try again later....");
    }
    },
    copy(text) {
    navigator.clipboard.writeText(text)
        .then(() => {
            alert('Magnet link copied to clipboard');
        })
        .catch(err => {
            alert('Failed to copy magnet link: ', err);
        });
}
  }
})
</script>
</html>